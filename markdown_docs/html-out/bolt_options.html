<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2019"><meta name="DC.rights.owner" content="(C) Copyright 2019"><meta name="DC.type" content="topic"><meta name="DC.format" content="HTML5"><meta name="DC.identifier" content="adding-options-to-bolt-commands"><link rel="stylesheet" type="text/css" href="commonltr.css"><title>Adding options to Bolt commands</title></head><body id="adding-options-to-bolt-commands"><main role="main"><article role="article" aria-labelledby="ariaid-title1"><h1 class="title topictitle1" id="ariaid-title1">Adding options to Bolt commands</h1><div class="body"><p class="p">Bolt commands can accept several command line options, some of which are required.</p><p class="p"><strong class="ph b">Parent topic:</strong><a class="xref" href="running_bolt.html">Using Bolt commands</a></p></div><article class="topic nested1" aria-labelledby="ariaid-title2" id="specify-target-nodes"><h2 class="title topictitle2" id="ariaid-title2">Specify target nodes</h2><div class="body"><p class="p">Specify the nodes that you want Bolt to target.</p><p class="p">For most&nbsp; Bolt&nbsp;commands, you specify target nodes with the&nbsp;<code class="ph codeph">--nodes</code>&nbsp;flag, for example, <code class="ph codeph">--nodes mercury</code>. For plans, you specify nodes as a list within the task plan itself or specify them as regular parameters, like&nbsp;<code class="ph codeph">nodes=neptune</code>.</p><p class="p">When targeting systems with the <code class="ph codeph">--nodes</code> flag, you can specify the transport either in the node URL for each host, such as <code class="ph codeph">--nodes winrm://mywindowsnode.mydomain</code>, or set a default transport for the operation with the<code class="ph codeph">--transport</code> option. If you do not specify a transport it will default to <code class="ph codeph">ssh</code>.</p></div><article class="topic nested2" aria-labelledby="ariaid-title3" id="specify-nodes-in-the-command-line"><h3 class="title topictitle3" id="ariaid-title3">Specify nodes in the command line</h3><div class="body"><ul class="ul"><li class="li"><p class="p">To specify multiple nodes with the <code class="ph codeph">--nodes</code> flag, use a comma-separated list of nodes:</p></li></ul><pre class="pre codeblock"><code>--nodes neptune,saturn,mars</code></pre><ul class="ul"><li class="li"><p class="p">To generate a node list with brace expansion, specify the node list with an equals sign \(<code class="ph codeph">=</code>\), such as <code class="ph codeph">--nodes=web{1,2}</code>.</p><pre class="pre codeblock"><code> bolt command run --nodes={web{5,6,7},elasticsearch{1,2,3}.subdomain}.mydomain.edu  </code></pre><p class="p">This command runs Bolt on the following hosts:</p><ul class="ul"><li class="li"><p class="p">elasticsearch1.subdomain.mydomain.edu</p></li><li class="li"><p class="p">elasticsearch2.subdomain.mydomain.edu</p></li><li class="li"><p class="p">elasticsearch3.subdomain.mydomain.edu</p></li><li class="li"><p class="p">web5.mydomain.edu</p></li><li class="li"><p class="p">web6.mydomain.edu</p></li><li class="li"><p class="p">web7.mydomain.edu</p></li></ul></li><li class="li"><p class="p">To pass nodes to Bolt in a file, pass the file name and relative location with the <code class="ph codeph">--nodes</code> flag and an <code class="ph codeph">@</code> symbol:</p><pre class="pre codeblock"><code>bolt command run --nodes @nodes.txt</code></pre><p class="p">For Windows PowerShell, add single quotation marks to define the file:</p><pre class="pre codeblock"><code>bolt command run --nodes '@nodes.txt'</code></pre></li><li class="li"><p class="p">To pass nodes on <code class="ph codeph">stdin</code>, on the command line, use a command to generate a node list, and pipe the result to Bolt with <code class="ph codeph">-</code> after <code class="ph codeph">--nodes</code>:</p></li></ul><pre class="pre codeblock"><code>&lt;COMMAND&gt; | bolt command run --nodes -</code></pre><pre class="pre codeblock"><code>For example, if you have a node list in a text file:

```
cat nodes.txt | bolt command run --nodes -
```</code></pre><ul class="ul"><li class="li"><p class="p">To pass nodes as IP addresses, use <code class="ph codeph">protocol://user:password@host:port</code> or inventory group name. You can use a domain name or IP address for <code class="ph codeph">host</code>, which is required. Other parameters are optional.</p></li></ul><pre class="pre codeblock"><code>bolt command run --nodes ssh://user:password@[fe80::34eb:ff1:b584:d7c0]:22,
ssh://root:password@hostname, pcp://host01, winrm://Administrator:password@hostname</code></pre></div></article><article class="topic nested2" aria-labelledby="ariaid-title4" id="specify-nodes-from-an-inventory-file"><h3 class="title topictitle3" id="ariaid-title4">Specify nodes from an inventory file</h3><div class="body"><p class="p">To specify nodes from an inventory file, reference nodes by node name, a glob matching names in the file, or the name of a group of nodes.</p><ul class="ul"><li class="li"><p class="p">To match all nodes in both groups listed in the inventory file example:</p></li></ul><pre class="pre codeblock"><code>--nodes elastic_search,web_app</code></pre><ul class="ul"><li class="li"><p class="p">To match all the nodes that start with elasticsearch in the inventory file example:</p></li></ul><pre class="pre codeblock"><code>--nodes 'elasticsearch*' </code></pre><p class="p">This inventory file defines two top-level groups: elastic\_search and web\_app.</p><pre class="pre codeblock"><code>groups:
  - name: elastic_search
    nodes:
      - elasticsearch1.subdomain.mydomain.edu
      - elasticsearch2.subdomain.mydomain.edu
      - elasticsearch3.subdomain.mydomain.edu
  - name: web_app
    nodes:
      - web5.mydomain.edu
      - web6.mydomain.edu
      - web7.mydomain.edu</code></pre><p class="p"><strong class="ph b">Related information</strong></p><p class="p"><a class="xref" href="inventory_file.html">Inventory file</a></p></div></article></article><article class="topic nested1" aria-labelledby="ariaid-title5" id="set-a-default-transport"><h2 class="title topictitle2" id="ariaid-title5">Set a default transport</h2><div class="body"><p class="p">To set a default transport protocol, pass it with the command with the <code class="ph codeph">--transport</code> option.</p><p class="p">Available transports are:</p><ul class="ul"><li class="li"><p class="p"><code class="ph codeph">ssh</code></p></li><li class="li"><p class="p"><code class="ph codeph">winrm</code></p></li><li class="li"><p class="p"><code class="ph codeph">local</code></p></li><li class="li"><p class="p"><code class="ph codeph">docker</code></p></li><li class="li"><p class="p"><code class="ph codeph">pcp</code></p></li></ul><p class="p">Pass the <code class="ph codeph">--transport</code> option after the nodes list:</p><pre class="pre codeblock"><code>bolt command run &lt;COMMAND&gt; --nodes win1 --transport winrm</code></pre><p class="p">This sets the transport protocol as the default for this command. If you set this option when running a plan, it is treated as the default transport for the entire plan run. Any nodes passed with transports in their URL or transports configured in inventory do not use this default.</p><p class="p">This is useful on Windows, so that you do not have to include the <code class="ph codeph">winrm</code> transport for each node. To override the default transport, specify the protocol on a per-host basis:</p><pre class="pre codeblock"><code>bolt command run facter --nodes win1,ssh://linux --transport winrm</code></pre><p class="p">If&nbsp;<code class="ph codeph">localhost</code>&nbsp;is passed to&nbsp;<code class="ph codeph">--nodes</code>&nbsp;when invoking Bolt, the&nbsp;<code class="ph codeph">local</code>&nbsp;transport is used automatically. To avoid this behavior, prepend the target with the desired transport, for example <code class="ph codeph">ssh://localhost</code>.</p></div></article><article class="topic nested1" aria-labelledby="ariaid-title6" id="specify-connection-credentials"><h2 class="title topictitle2" id="ariaid-title6">Specify connection credentials</h2><div class="body"><p class="p">To run Bolt on target nodes that require a username and password, pass credentials as options on the command line.</p><p class="p">Bolt connects to remote nodes with either SSH or WinRM.</p><p class="p">You can manage SSH connections with an SSH configuration file \(<code class="ph codeph">~/.ssh/config</code>\) on your workstation, or you can specify the username and password on the command line.</p><p class="p">WinRM connections always require you to pass the username and password with the <code class="ph codeph">bolt</code> command:</p><pre class="pre codeblock"><code>bolt command run 'gpupdate /force' --nodes winrm://pluto --user Administrator --password &lt;PASSWORD&gt;</code></pre><p class="p">To have Bolt securely prompt for a password, use the <code class="ph codeph">--password</code> or <code class="ph codeph">-p</code> flag without supplying any value. Bolt then prompts for the password, so that it does not appear in a process listing or on the console.&nbsp;</p></div></article><article class="topic nested1" aria-labelledby="ariaid-title7" id="rerunning-commands-based-on-the-last-result"><h2 class="title topictitle2" id="ariaid-title7">Rerunning commands based on the last result</h2><div class="body"><p class="p">After every execution, Bolt writes information about the result of that run to a <code class="ph codeph">.rerun.json</code> file inside the Bolt project directory. That file can then be used to specify nodes for future commands.</p><p class="p">To attempt to retry a failed action on target nodes, use <code class="ph codeph">--rerun failure</code>. To continue targeting those nodes, pass <code class="ph codeph">--no-save-rerun</code> to prevent updating the file.</p><pre class="pre codeblock"><code>bolt command run false --nodes all
bolt command run whoami --rerun failure --no-save-rerun</code></pre><p class="p">If one command is dependent on the success of a previous command, you can target the successful nodes with <code class="ph codeph">--rerun success</code>.</p><pre class="pre codeblock"><code>bolt task run package action=install name=httpd --nodes all
bolt task run server action=restart name=httpd --rerun success</code></pre><p class="p"><strong class="ph b">Note:</strong> When a plan does not return a <code class="ph codeph">ResultSet</code> object, Bolt can't save information for reruns and <code class="ph codeph">.rerun.json</code> is deleted.</p><p class="p"><strong class="ph b">Related information</strong></p><p class="p"><a class="xref" href="bolt_project_directories.html#">Project directories</a></p></div></article></article></main></body></html>