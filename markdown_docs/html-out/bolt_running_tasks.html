<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2019"><meta name="DC.rights.owner" content="(C) Copyright 2019"><meta name="DC.type" content="topic"><meta name="DC.creator" content="Jean Bond <jean@puppet.com\&gt;"><meta name="DC.format" content="HTML5"><meta name="DC.identifier" content="running-tasks"><link rel="stylesheet" type="text/css" href="commonltr.css"><title>Running tasks</title></head><body id="running-tasks"><main role="main"><article role="article" aria-labelledby="ariaid-title1"><h1 class="title topictitle1" id="ariaid-title1">Running tasks</h1><div class="body"><p class="p">Bolt can run Puppet tasks on remote nodes without requiring any Puppet infrastructure.&nbsp;</p><p class="p">To execute a task, run <code class="ph codeph">bolt task run</code>, specifying:</p><ul class="ul"><li class="li"><p class="p">The full name of the task, formatted as <code class="ph codeph">&lt;MODULE::TASK&gt;</code>, or as <code class="ph codeph">&lt;MODULE&gt;</code> for a module's main task \(the <code class="ph codeph">init</code> task\).</p></li><li class="li"><p class="p">Any task parameters, as <code class="ph codeph">parameter=value</code>.</p></li><li class="li"><p class="p">The nodes on which to run the task and the connection protocol, with the <code class="ph codeph">--nodes</code> flag.</p></li><li class="li"><p class="p">If credentials are required to connect to the target node, the username and password, with the <code class="ph codeph">--user</code> and <code class="ph codeph">--password</code> flags.</p></li></ul><p class="p">For example, to run the <code class="ph codeph">sql</code> task from the <code class="ph codeph">mysql</code> module on node named neptune:</p><pre class="pre codeblock"><code>bolt task run mysql::sql database=mydatabase sql="SHOW TABLES" --nodes neptune --modulepath ~/modules</code></pre><p class="p">To run the main module task defined in <code class="ph codeph">init</code>, refer to the task by the module name only. For example, the <code class="ph codeph">puppetlabs-package</code> module contains only one task, defined as <code class="ph codeph">init</code>, but this task can execute several actions. To run the <code class="ph codeph">status</code> action from this module to check whether the vim package is installed, you run:</p><pre class="pre codeblock"><code>bolt task run package action=status name=vim --nodes neptune --modulepath ~/modules</code></pre><p class="p"><strong class="ph b">Tip:</strong> Bolt is packaged with a collection of modules that contain useful plans to support common workflows. For details, see <a class="xref" href="packaged_modules.html">Packaged modules</a>.</p><p class="p"><strong class="ph b">Parent topic:</strong><a class="xref" href="writing_tasks_and_plans.html">Tasks and plans</a></p></div><article class="topic nested1" aria-labelledby="ariaid-title2" id="passing-structured-data"><h2 class="title topictitle2" id="ariaid-title2">Passing structured data</h2><div class="body"><p class="p">If one of your task or plan parameters accept structured data like an <code class="ph codeph">array</code> or <code class="ph codeph">hash</code>, it can be passed as JSON from the command line.</p><p class="p">If a single parameter can be parsed as JSON and the parsed value matches the parameter's type specification in the task metadata or plan definition, it can be passed with <code class="ph codeph">&lt;&gt;param=value</code> syntax. Make sure to wrap the JSON value in single quotes to prevent <code class="ph codeph">"</code> characters from being swallowed by the shell.</p><pre class="pre codeblock"><code>bolt task run mymodule::mytask --nodes app1.myorg.com load_balancers='["lb1.myorg.com", "lb2.myorg.com"]'</code></pre><pre class="pre codeblock"><code>bolt plan run mymodule::myplan load_balancers='["lb1.myorg.com", "lb2.myorg.com"]'</code></pre><p class="p">If you want to pass multiple structured values or are having trouble with the magic parsing of single parameters, you can pass a single JSON object for all parameters with the <code class="ph codeph">--params</code> flag.</p><pre class="pre codeblock"><code>bolt task run mymodule::mytask --nodes app1.myorg.com --params '{"load_balancers": ["lb1.myorg.com", "lb2.myorg.com"]}'</code></pre><pre class="pre codeblock"><code>bolt plan run mymodule::myplan --params '{"load_balancers": ["lb1.myorg.com", "lb2.myorg.com"]}'</code></pre><p class="p">You can also load parameters from a file by putting <code class="ph codeph">@</code> before the file name.</p><pre class="pre codeblock no-highlight"><code>bolt task run mymodule::mytask --nodes app1.myorg.com --params @param_file.json</code></pre><pre class="pre codeblock no-highlight"><code>bolt plan run mymodule::myplan --params @param_file.json</code></pre><p class="p">To pass JSON values in PowerShell without worrying about escaping, use <code class="ph codeph">ConvertTo-Json</code></p><pre class="pre codeblock"><code>bolt task run mymodule::mytask --nodes app1.myorg.com --params $(@{load_balancers=@("lb1.myorg.com","lb2.myorg.com")} | ConvertTo-Json)</code></pre><pre class="pre codeblock"><code>bolt plan run mymodule::myplan --nodes app1.myorg.com --params $(@{load_balancers=@("lb1.myorg.com","lb2.myorg.com")} | ConvertTo-Json)</code></pre></div></article><article class="topic nested1" aria-labelledby="ariaid-title3" id="specifying-the-module-path"><h2 class="title topictitle2" id="ariaid-title3">Specifying the module path</h2><div class="body"><p class="p">In order for Bolt to find a task or plan, the task or plan must be in a module on the <code class="ph codeph">modulepath</code>. By default, the <code class="ph codeph">modulepath</code> includes <code class="ph codeph">modules/</code> and <code class="ph codeph">site-modules/</code> directories inside the Bolt project directory.</p><p class="p">If you are developing a new plan, you can specify <code class="ph codeph">--modulepath &lt;PARENT_DIR_OF/MODULE&gt;</code> to tell Bolt where to load the module. For example, if your module is in <code class="ph codeph">~/src/modules/my_module/</code>, run Bolt with <code class="ph codeph">--modulepath ~/src/module</code>. If you often use the same <code class="ph codeph">modulepath</code>, you can set <code class="ph codeph">modulepath</code> in <code class="ph codeph">bolt.yaml</code>.</p></div></article></article></main></body></html>