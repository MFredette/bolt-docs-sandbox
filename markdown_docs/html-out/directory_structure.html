<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2019"><meta name="DC.rights.owner" content="(C) Copyright 2019"><meta name="DC.type" content="topic"><meta name="DC.creator" content="Melissa Amos <melissa.amos@puppet.com\&gt;"><meta name="DC.format" content="HTML5"><meta name="DC.identifier" content="directory-structures-for-tasks-and-plans"><link rel="stylesheet" type="text/css" href="commonltr.css"><title>Directory structures for tasks and plans</title></head><body id="directory-structures-for-tasks-and-plans"><main role="main"><article role="article" aria-labelledby="ariaid-title1"><h1 class="title topictitle1" id="ariaid-title1">Directory structures for tasks and plans</h1><div class="body"><p class="p">Puppet tasks, plans, functions, classes and types must exist inside a Puppet, module in order for Bolt to load them. Bolt loads modules by searching for module directories on the modulepath.</p><p class="p">By default, the <code class="ph codeph">modulepath</code> includes the <code class="ph codeph">modules/</code> and <code class="ph codeph">site-modules</code> directories in the <a class="xref" href="bolt_project_directories.html#">Bolt project directory</a>.</p><p class="p"><strong class="ph b">Parent topic:</strong><a class="xref" href="writing_tasks_and_plans.html">Tasks and plans</a></p></div><article class="topic nested1" aria-labelledby="ariaid-title2" id="directory-structure-of-a-module"><h2 class="title topictitle2" id="ariaid-title2">Directory structure of a module</h2><div class="body"><p class="p">A module is a sub-directory of one of the directories on the modulepath. In order for Bolt to load tasks and plans, they must exist in the <code class="ph codeph">tasks/</code> or <code class="ph codeph">plans/</code> directory of a module with the correct name.</p><p class="p"><strong class="ph b">Tip:</strong> You can use the Puppet Development Kit \(PDK\) to create modules and add tasks to it.</p><p class="p">A typical module for use with Bolt may contain these directories:</p><pre class="pre codeblock"><code>├── data/
├── files/
├── hiera.yaml
├── lib/
├── manifests/
├── metadata.json
├── plans/
└── tasks/</code></pre><table class="table"><caption></caption><colgroup><col><col></colgroup><thead class="thead"><tr class="row"><th class="entry" id="directory-structure-of-a-module__entry__1">Directory</th><th class="entry" id="directory-structure-of-a-module__entry__2">Contents</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry" headers="directory-structure-of-a-module__entry__1"><code class="ph codeph">data</code></td><td class="entry" headers="directory-structure-of-a-module__entry__2">Hiera data that can be used when applying a manifest block.</td></tr><tr class="row"><td class="entry" headers="directory-structure-of-a-module__entry__1"><code class="ph codeph">files</code></td><td class="entry" headers="directory-structure-of-a-module__entry__2">Static files that can be loaded by a plan or required as a dependency of a task. Prefer putting non-Ruby libraries used by a task here.</td></tr><tr class="row"><td class="entry" headers="directory-structure-of-a-module__entry__1"><code class="ph codeph">functions</code></td><td class="entry" headers="directory-structure-of-a-module__entry__2">Puppet language functions that can be used from a plan.</td></tr><tr class="row"><td class="entry" headers="directory-structure-of-a-module__entry__1"><code class="ph codeph">hiera.yaml</code></td><td class="entry" headers="directory-structure-of-a-module__entry__2">Hiera configuration for this module.</td></tr><tr class="row"><td class="entry" headers="directory-structure-of-a-module__entry__1"><code class="ph codeph">lib</code></td><td class="entry" headers="directory-structure-of-a-module__entry__2">Typically Ruby code, such as custom Puppet functions, types, or providers.</td></tr><tr class="row"><td class="entry" headers="directory-structure-of-a-module__entry__1"><code class="ph codeph">manifests</code></td><td class="entry" headers="directory-structure-of-a-module__entry__2">Classes and other Puppet code usable when applying a manifest block.</td></tr><tr class="row"><td class="entry" headers="directory-structure-of-a-module__entry__1"><code class="ph codeph">metadata.json</code></td><td class="entry" headers="directory-structure-of-a-module__entry__2">Typical metadata for a module describing version, operating system compatibility, and other module dependencies.</td></tr><tr class="row"><td class="entry" headers="directory-structure-of-a-module__entry__1"><code class="ph codeph">plans</code></td><td class="entry" headers="directory-structure-of-a-module__entry__2">Plans, which must end in the <code class="ph codeph">.pp</code> extension.</td></tr><tr class="row"><td class="entry" headers="directory-structure-of-a-module__entry__1"><code class="ph codeph">tasks</code></td><td class="entry" headers="directory-structure-of-a-module__entry__2">Tasks and their metadata.</td></tr></tbody></table></div><article class="topic nested2" aria-labelledby="ariaid-title3" id="where-to-put-module-code"><h3 class="title topictitle3" id="ariaid-title3">Where to put module code</h3><div class="body"><p class="p">Modules can either be written directly in <code class="ph codeph">site-modules/</code> or be installed from the Puppet Forge or a code repository into <code class="ph codeph">modules/</code>.</p></div></article></article><article class="topic nested1" aria-labelledby="ariaid-title4" id="modules-for-projects"><h2 class="title topictitle2" id="ariaid-title4">Modules for projects</h2><div class="body"><p class="p">Modules developed to support a particular project can be developed directly in the <code class="ph codeph">site-modules</code> directory of the Bolt project directory.</p><p class="p">Create a new directory for each module inside <code class="ph codeph">site-modules</code> that matches the modules name or use <code class="ph codeph">pdk new module</code> to create a skeleton structure.</p></div></article><article class="topic nested1" aria-labelledby="ariaid-title5" id="standalone-modules"><h2 class="title topictitle2" id="ariaid-title5">Standalone modules</h2><div class="body"><p class="p">Standalone modules can be published to the Forge or saved in a shared code repository so that modules can be used from multiple projects or shared publicly.</p><p class="p">To use a standalone module, <a class="xref" href="bolt_installing_modules.html#">install the module</a> into the project directory.</p><p class="p">To create a standalone module, run <code class="ph codeph">pdk new module</code> outside of the project directory, develop the module, then push it to a code repository or the Forge before using it in your project.</p><p class="p">Follow these tips for managing standalone modules:</p><ul class="ul"><li class="li"><p class="p">Add <code class="ph codeph">modules/*</code> to <code class="ph codeph">.gitignore</code> of your project to prevent accidentally committing standalone modules.</p></li><li class="li"><p class="p">When you run tasks and plans within a project directory, the modulepath \(<code class="ph codeph">modules/</code> and <code class="ph codeph">site-modules/</code>\) is searched for modules containing Bolt content. If a module is found in <code class="ph codeph">modules</code>, tasks and plans from the version of the module in <code class="ph codeph">site-modules</code> are ignored. Remove a module from <code class="ph codeph">site-modules</code> if you convert it to a standalone module.</p></li><li class="li"><p class="p">As a best practice, write automated tests for the tasks and plans in your module, if possible. For information about automated testing patterns, check out these resources: <a class="xref" href="https://github.com/puppetlabs/puppetlabs-facts" target="_blank">Example of unit testing plans and integration \(acceptance\) testing tasks</a> \(GitHub\) and <a class="xref" href="https://puppet.com/blog/writing-robust-puppet-bolt-tasks-guide" target="_blank">Writing Robust Puppet Bolt Tasks: A Guide</a> \(Puppet blog\).</p></li></ul></div></article></article></main></body></html>